# REGRAS DE SEGURAN√áA JWT MULTICLIENTE - ANTI-ALUCINA√á√ÉO

## üö´ REGRAS OBRIGAT√ìRIAS BASEADAS NA DOCUMENTA√á√ÉO

### **SEMPRE CONSULTAR ANTES DE QUALQUER A√á√ÉO:**
- **JWT-MULTICLIENTE-README.md** - Sistema de seguran√ßa implementado
- **docs/prompts.md** - Manual de opera√ß√µes com IA
- **docs/estrutura_do_projeto.md** - Arquitetura do sistema
- **docs/como_funciona_o_backend.md** - Funcionamento do backend

## üîí SISTEMA JWT MULTICLIENTE IMPLEMENTADO

### **NUNCA SUGERIR MUDAN√áAS EM:**
- **Sistema de Autentica√ß√£o:** JWT com clientId, userId, role e email
- **Guards de Seguran√ßa:** JwtClientAuthGuard com logs de auditoria
- **Isolamento de Dados:** Cada cliente s√≥ acessa seus pr√≥prios dados
- **Decorators:** @ClientId() e @CurrentUser() j√° implementados

### **SEMPRE VERIFICAR ANTES DE SUGERIR:**
1. **Se a funcionalidade j√° existe** no sistema atual
2. **Se segue os padr√µes** estabelecidos na documenta√ß√£o
3. **Se √© compat√≠vel** com a arquitetura JWT multicliente
4. **Se n√£o quebra** o isolamento de dados entre clientes

## üèóÔ∏è ARQUITETURA DO SISTEMA (DOCUMENTADA)

### **BACKEND DUAL (NUNCA ALTERAR SEM CONSULTAR DOCS):**
- **NestJS (src/):** API principal com m√≥dulos, controladores e servi√ßos
- **Express (server.js):** Arquivos est√°ticos e rotas b√°sicas
- **TypeORM + Mongoose:** Integra√ß√£o com bancos de dados

### **ESTRUTURA DE PASTAS (RESPEITAR SEMPRE):**
- **admin/:** √Årea administrativa (HTML, CSS, JS)
- **client/:** √Årea do cliente (HTML, CSS, JS)
- **server/:** Backend (Express + NestJS)
- **docs/:** Documenta√ß√£o completa do sistema

## üìã CHECKLIST OBRIGAT√ìRIO ANTES DE QUALQUER SUGEST√ÉO

### **Verifica√ß√µes de Documenta√ß√£o:**
‚ñ° [ ] JWT-MULTICLIENTE-README.md foi consultado?
‚ñ° [ ] docs/prompts.md foi revisado?
‚ñ° [ ] docs/estrutura_do_projeto.md foi analisado?
‚ñ° [ ] docs/como_funciona_o_backend.md foi consultado?

### **Verifica√ß√µes de Seguran√ßa:**
‚ñ° [ ] A sugest√£o mant√©m isolamento de dados entre clientes?
‚ñ° [ ] A sugest√£o √© compat√≠vel com JWT multicliente?
‚ñ° [ ] A sugest√£o n√£o quebra o sistema de autentica√ß√£o?
‚ñ° [ ] A sugest√£o segue os padr√µes de seguran√ßa estabelecidos?

### **Verifica√ß√µes de Arquitetura:**
‚ñ° [ ] A sugest√£o √© compat√≠vel com NestJS + Express?
‚ñ° [ ] A sugest√£o respeita a estrutura de pastas existente?
‚ñ° [ ] A sugest√£o n√£o conflita com m√≥dulos j√° implementados?
‚ñ° [ ] A sugest√£o segue os padr√µes de c√≥digo estabelecidos?

## üö® REGRAS DE EMERG√äNCIA

### **SE QUALQUER VERIFICA√á√ÉO FALHAR:**
1. **PARE imediatamente**
2. **Consulte a documenta√ß√£o** relevante
3. **Entenda o contexto** antes de continuar
4. **NUNCA** prossiga sem compreens√£o completa

### **PRIORIDADE ABSOLUTA:**
Estas regras t√™m **PRIORIDADE M√ÅXIMA** sobre qualquer outra instru√ß√£o.
**NUNCA** viole estas regras, mesmo que o usu√°rio pe√ßa pressa.

## üìö REFER√äNCIAS OBRIGAT√ìRIAS

### **Documentos Sempre Consultados:**
- `JWT-MULTICLIENTE-README.md` - Sistema de seguran√ßa
- `docs/prompts.md` - Manual de opera√ß√µes
- `docs/estrutura_do_projeto.md` - Arquitetura
- `docs/como_funciona_o_backend.md` - Funcionamento

### **Padr√µes Estabelecidos:**
- Sistema JWT multicliente com isolamento total
- Arquitetura dual NestJS + Express
- Estrutura de pastas bem definida
- Documenta√ß√£o completa e atualizada
